{% extends "base.html" %}
{% block content %}

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="google-adsense-account" content="ca-pub-4415407797807365">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">

    <title>{{ title if title else "ClientWise" }}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4415407797807365"
     crossorigin="anonymous"></script>
</head>

<div class="container my-4">
    <h2>Gerenciamento de Investimentos</h2>
    <p>Aqui você pode gerenciar seus investimentos!!.</p>
</div>

<br>
<br>

<div class="card mb-4">
    <div class="card-header bg-primary text-white text-center">
                <strong>Cadastro de investimento</strong>
    </div>
    <div class="container my-4">
        <form method="POST" enctype="multipart/form-data">
            <div id="form-manual">
                <div class="mb-3">
                    <label for="nome">Nome da Campanha:</label>
                    <input type="text" name="nome" class="form-control">
                </div>
                <div class="mb-3">
                    <label for="descricao">Descrição:</label>
                    <input type="text" name="descricao" class="form-control">
                </div>
                <div class="mb-3">
                    <label for="valor">Valor Investido:</label>
                    <input type="number" id="valor" name="valor" class="form-control">
                </div>
                <div class="mb-3">
                    <label for="tipo">Tipo de Pagamento:</label>
                    <select name="pagamento" class="form-control">
                        <option value="mensal" class="form-control" name="tipo">Mensal</option>
                        <option value="anual" class="form-control" name="tipo">Anual</option>
                    </select>
                </div>
                <div class="mb-3">
                    <label for="duracao">Recorrencia (em anos ou meses):</label>
                    <input type="number" name="duracao" id="duracao" class="form-control" placeholder=""0.1" para recorrência indefinida">
                </div>
                <div class="mb-3">
                    <label for="valor_total"> Valor Total do Investimento:</label>
                    <label id="valor_total_label" class="form-control">0.00</label>
                </div>
            </div>
            <button type="submit" class="btn btn-primary">Cadastrar</button>
        </form>
    </div>
</div>

<br>

<div class="card mb-4">
        <div class="card-header bg-secondary text-white text-center">
            <strong>Lista de Investimentos</strong>
        </div>
        <div class="card-body">
            <table class="table table-striped table-hover">
                <thead>
                    <tr>
                        <th>Nome</th>
                        <th>descrição</th>
                        <th>Valor</th>
                        <th>Duração</th>
                        <th>Ativo</th>
                    </tr>
                </thead>
                <tbody>
                    {% for investimento in investimentos_df %}
                    <tr>
                        <td>{{ investimento['nome'] }}</td>
                        <td>{{ investimento['descricao'] }}</td>
                        <td>{{ investimento['valor'] }}</td>
                        <td>{{ investimento['duracao'] }}</td>
                        <td>{{ 'Sim' if investimento['status'] else 'Não' }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
</div>

<script>
    // Captura os elementos de entrada e a label do resultado
    const valorInput = document.getElementById('valor');
    const duracaoInput = document.getElementById('duracao');
    const resultLabel = document.getElementById('valor_total_label');

    // Função para atualizar o valor total
    function updateResult() {
        const valor = parseFloat(valorInput.value) || 0;
        let duracao = parseFloat(duracaoInput.value) || 0;

        // Verifica se a duração é "0.1"
        if (duracao === 0.1) {
            duracao = 1; // Adota 1 como valor padrão
        }

        // Calcula o resultado
        const result = valor * duracao;

        // Atualiza o texto da label
        resultLabel.textContent = result.toFixed(2);
    }

    // Adiciona eventos para atualizar o resultado em tempo real
    valorInput.addEventListener('input', updateResult);
    duracaoInput.addEventListener('input', updateResult);
</script>

{% endblock %}